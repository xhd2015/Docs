!function(){"use strict";function t(t){t=t?t:{},this.channelUrl=t.channelUrl||location.protocol+"//"+location.hostname+"/?vt=4&urlHistory="+this.channelName(),this.startTime=0,this.endTime=0,this.init()}t.prototype={constructor:t,init:function(){this.goReturnChannel()},goReturnChannel:function(){if(this.startTime=Date.parse(new Date),this.HasHistoryUrl()){var t=this.channelUrl,n=location.href;history.replaceState(null,"",t),history.pushState("","",n),window.addEventListener("popstate",function(){this.endTime=Date.parse(new Date),this.endTime-this.startTime>500&&(this.suds_count(),setTimeout(function(){location.href=t},200))}.bind(this))}},HasHistoryUrl:function(){return history.pushState&&!n.Utils.isSinaNews()&&!n.Utils.isQQ()&&!n.Utils.isWeibo()&&this.isChannel()&&this.isOldAdd()&&this.isWm()&&this.isHomePage()&&this.isHttps()},suds_count:function(){var t=this.channelName();window.suds_count&&window.suds_count({type:"sudsHistory",name:t,title:"回退拦截",index:0})},getUrlString:function(t){var n=location.href,i="(?:\\?|&){1}"+t+"=([^&]*)",e=new RegExp(i,"gi");return e.exec(n),RegExp.$1},channelName:function(){var t=location.hostname;return t.split(".")[0]},isChannel:function(){return-1==document.referrer.indexOf(this.channelName())},isOldAdd:function(){return-1==document.referrer.indexOf("urlHistory="+this.channelName())},isWm:function(){return 3206!=this.getUrlString("wm")},isHomePage:function(){return-1==document.referrer.indexOf("sina.cn")},isHttps:function(){return-1==document.location.href.indexOf("pos=108")}};var n={};n.Utils={_UA:navigator.userAgent.toLowerCase(),UAIdentify:{weibo:"weibo",qq:"qq/",sinanews:"sinanews"},isInclude:function(t,n){return t.indexOf(n)>-1},isSinaNews:function(){var t=this.UAIdentify,n=this.isInclude(this._UA,t.sinanews);return n?!0:!1},isWeibo:function(){var t=this.UAIdentify,n=this.isInclude(this._UA,t.weibo);return n?!0:!1},isQQ:function(){var t=this.UAIdentify,n=this.isInclude(this._UA,t.qq);return n?!0:!1}},window.addEventListener("load",function(){new t})}(window,document);