(function(d){var a=/https?:\/\/.*douban.[com|fm]/;var e=window.dui||{},c={pageSelector:".page",currentPage:null,defaultPage:"#popup_login",onHashChange:null,onNavigate:null,customNavigate:null},b=false,i={init:function(j){if(b){return}b=true;j=d.extend({},c,j);f(j);if(location.hash){h(j,location.hash,true)}else{h(j,j.defaultPage,true)}},LOGIN_HEIGHT:382,REGISTER_HEIGHT:480,setParentIframe:function(j){if(window.name&&a.test(window.name)){window.top.postMessage(j,window.name)}}};function h(k,l,j){location.hash=l;if(d.isFunction(k.customNavigate)){k.customNavigate(k,l,j)}else{d(k.pageSelector).hide().filter("[data-id="+l+"]").show()}d.isFunction(k.onNavigate)&&k.onNavigate(k.currentPage,l)}function g(j,k){d.isFunction(j.onHashChange)&&j.onHashChange(k);h(j,location.hash)}function f(k){if("onhashchange" in window){d(window).on("hashchange",function(n){g(k,n)})}else{var j=window.location,l=j.href,m=j.hash;setInterval(function(){var o=j.href,n=j.hash;if(n!=m&&typeof window.onhashchange==="function"){g(k,{type:"hashchange",oldURL:l,newURL:o});l=o;m=n}})}}e.SimpleRouter=i;window.dui=e})(jQuery);