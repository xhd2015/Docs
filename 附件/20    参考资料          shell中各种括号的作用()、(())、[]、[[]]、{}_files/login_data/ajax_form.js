;(function(f){var d=window.dui||{},b=function(h,j){var i=Array.prototype.slice.call(arguments,2);return f.isFunction(h)&&h.apply(j,i)},g={form:null,method:null,url:null,validate:function(h){return true},disable:function(h,i){i=i||"";var j=f(document.body);j.find("#mask").remove();j.append('<div id="mask"><div>'+i+"</div></div>")},enable:function(h){f(document.body).find("#mask").remove()},onAjaxStart:function(h){this.disable(h)},onAjaxEnd:function(h){this.enable(h)},onAjaxError:function(i,h){h.find(".field-tips").html("断网了,请再试一次~")},onAjaxSuccess:function(i,h){h.find(".field-tips").html("")},isSuccess:function(i,h){return true},onError:null,onSuccess:null,onData:null},a=function(h){this._config=f.extend(true,{},g,h)};a.prototype={init:function(){var h=f(this._config.form);var i=this._config;h.on("submit",function(){if(f.isFunction(i.validate)&&i.validate(h)){e(h,i)}return false});return this},updateConfig:function(h){this._config=f.extend(true,{},this._config,h);return this},disable:function(i){var h=f(this._config.form);f.isFunction(this._config.disable)&&this._config.disable(h,i)},enable:function(i){var h=f(this._config.form);f.isFunction(this._config.enable)&&this._config.enable(h,i)}};function e(h,j){j.onAjaxStart(h);f.isFunction(j.onAjaxStart)&&j.onAjaxStart(h);var k=j.method||h.attr("method")||"post";var i=j.url||h.attr("action");f.ajax({type:k.toLocaleUpperCase(),url:i,data:c(h),dataType:"json"}).done(function(l){f.isFunction(j.onAjaxEnd)&&j.onAjaxEnd(h);f.isFunction(j.onAjaxSuccess)&&j.onAjaxSuccess(l,h);if(f.isFunction(j.isSuccess)&&j.isSuccess(l,h)){f.isFunction(j.onSuccess)&&j.onSuccess(l,h)}else{f.isFunction(j.onError)&&j.onError(l,h)}}).fail(function(l){f.isFunction(j.onAjaxEnd)&&j.onAjaxEnd(h);f.isFunction(j.onAjaxError)&&j.onAjaxError(l,h)})}function c(h){var i={};h.find("[name]").each(function(p,l){var k=f(l);var j=k.attr("name");var m="";var o=true;switch(k.attr("type")){case"checkbox":o=k.is(":checked");m=k.val();break;case"radio":m=k.filter(":checked").val();break;default:m=k.val();break}if(o){i[j]=m}});return i}d.AjaxForm=a;window.dui=d})(jQuery);