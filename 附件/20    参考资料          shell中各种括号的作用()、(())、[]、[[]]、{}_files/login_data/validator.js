(function(f){var b=window.dui||{},g={form:null,rules:null,events:[],showMessage:true,showFieldError:function(h,i){h.siblings(".tips-error").remove();h.parent().append('<div class="tips tips-error">'+i+"</div>")},showGlobalError:function(h,j){var i=h.find(".field-tips").html("");i.append("<div>"+j+"</div>")},clearGlobalError:function(h){h.find(".field-tips").html("")},clearFieldError:function(h){h.siblings(".tips-error").remove()},clearAllError:function(h){h.find(".field-tips").html("");h.find(".tips-error").remove()},ruleFuns:{required:function(h){return !!f.trim(h)},phone:function(h){return !h||/^1\d{10}$/.test(h)},email:function(h){return !h||/^([a-zA-Z0-9_\.\-\+])+\@(\w)+([\.-]\w+)+$/.test(h)},alias:function(h){if(/^\d+$/.test(h)){return this.phone(h)}else{return this.email(h)}},pwd:function(h){return h&&h.length>=6},loginPwd:function(h){return h},name:function(h){return h&&h.replace(/[^\x00-\xff]/g,"**").length<=14}},messages:{required:"必填",phone:"手机号码格式错误",email:"邮箱格式错误",alias:"手机号 / 邮箱格式不正确",loginPwd:"密码最短6位",pwd:"密码最短6位",name:"名号长度不能超过14个英文或7个汉字"}};var c=function(h){this._config=f.extend(true,{},g,{rules:a(f(h.form))},h)};c.prototype={init:function(){var i=this._config;var h=f(i.form);h.on("submit",function(){return e(h,i)});f.each(i.rules||[],function(j,l){var k=h.find("[name="+j+"]");f.each(i.events||[],function(m,n){k.on(n,function(){d(h,j,i)})})});return this},isValidate:function(h){h=f.extend({},this._config,h);return e(f(h.form),h)},isFieldValidate:function(h,k){k=f.extend({},this._config,k);var i=f(k.form);var j=h;if(typeof j!=="string"){j=j.attr("name")}return d(i,j,k)},showFieldError:function(h,l){var j=this._config;var i=f(j.form);var k=h;if(typeof k==="string"){k=i.find("[name="+k+"]")}f.isFunction(j.showFieldError)&&j.showFieldError(k,l);return this},showGlobalError:function(h,j){var i=this._config;f.isFunction(i.showGlobalError)&&i.showGlobalError(h,j)},clearGlobalError:function(h){var i=this._config;f.isFunction(i.showGlobalError)&&i.clearGlobalError(h)},clearAllError:function(){var h=f(this._config.form);f.isFunction(this._config.clearAllError)&&this._config.clearAllError(h);return this},clearFieldError:function(h){var i=f(this._config.form);var j=h;if(typeof j==="string"){j=i.find("[name="+j+"]")}f.isFunction(this._config.clearFieldError)&&this._config.clearFieldError(j);return this}};function e(h,i){f.isFunction(i.clearAllError)&&i.clearAllError(h);var j=true;f.each(i.rules,function(k,l){if(!d(h,k,i)){j=false}});return j}function d(p,i,j){var m=p.find("[name="+i+"]");var n=j.rules[i];for(var l in n){if(!n.hasOwnProperty(l)){continue}if(!n[l]){continue}var h=m.val();var k=f.isFunction(j.ruleFuns[l])&&j.ruleFuns[l](h);if(!k){var o=j.messages[l];if(typeof o!=="string"){o=o[i]||""}j.showMessage&&f.isFunction(j.showFieldError)&&j.showFieldError(m,o);return false}}j.showMessage&&f.isFunction(j.clearFieldError)&&j.clearFieldError(m);return true}function a(h){var i={};h.find("[name]").each(function(){var m=f(this),l=m.attr("data-rules"),j=m.attr("name");if(l){try{i[j]=f.parseJSON(l)}catch(k){console.error(new SyntaxError("form[name="+h.attr("name")+"]'s field[name="+j+"]'s data-rules is not a validate json"))}}});return i}b.Validator=c;window.dui=b})(jQuery);